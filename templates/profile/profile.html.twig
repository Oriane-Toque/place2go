{% extends "layout/base.html.twig" %}

{% block title %}Dashboard{% endblock %}

{% block body %}
<div class="container">

	<div id="profile">

		{# Navigation secondaire du dashboard + informations #}
		{% include "profile/_nav_aside.html.twig" %}

		{# Contenu du profil #}
		<div class="contentProfile">

			<!-- Pills navs -->
			<ul class="nav nav-pills mb-3" id="profile-navbar" role="tablist">
			<li class="nav-item" role="navbar">
				<a class="nav-link active" id="my-events-tab" href="#my-events" role="tab"
				data-mdb-toggle="pill" aria-controls="my-events" aria-selected="false">
				Mes sorties
				</a>
			</li>
			<li class="nav-item" role="presentation">
				<a class="nav-link" id="friend-event-tab" href="#friend-events" role="tab"
				data-mdb-toggle="pill" aria-controls="friend-events" aria-selected="false">
				Sorties de mes amis
				</a>
			</li>
			<li class="nav-item" role="presentation">
				<a class="nav-link" id="saves-tab" href="#saves" role="tab"
				data-mdb-toggle="pill" aria-controls="saves" aria-selected="false">
				Recherches sauvegardés
				</a>
			</li>
			</ul>
			<!-- Pills navs -->

			<div class="tab-content" id="tabs-content">

				<div class="tab-pane fade show active" id="my-events" role="tabpanel" aria-labelledby="my-events-tab">

					{# Les derniers sorties proposées par l'utilisateur #}
					<section class="contentProfile__lastExits">
						<h2>Dernières sorties publiées</h2>
						{# Début carte sortie #}
						{% for event in userLastExits %}
							<div class="card mb-3">
								<div class="row g-0">

									<div class="contentProfile__lastExits-picture">
										{# TODO Image de la sortie (améliorations) #}
										<img
											src="https://mdbootstrap.com/wp-content/uploads/2020/06/vertical.jpg"
											alt="..."
											class="img-fluid"
										/>
									</div>

									<div class="contentProfile__lastExits-infos">
										<div class="card-header">
											<h3 class="card-title">{{ event.title }}</h3>
											<p><time datetime="{{ event.eventDate|date("d MMMM Y à HH:mm") }}">{{ event.eventDate|format_date('none', 'd MMMM Y à HH:mm', null, 'gregorian', 'fr') }}</time></p>
										</div>
										<div class="card-body">
											<div class="contentProfile__lastExits-infos_details">
												<p class="card-text"><span>Organisé par :</span> {{ event.author }}</p>
												{# fonction length de twig pour retourner le nombre de participants #}
												<p class="card-text"><span>Nbr part :</span> {{ event.attendants|length }} / {{ event.maxAttendants }}</p>
											</div>
											<div class="contentProfile__lastExits-infos_actions">
												{# Bouton pour voir les détails #}
												<a class="--show btn btn-primary btn-floating" href="{{ path("app_event_show", {id:event.id}) }}" role="button" data-mdb-toggle="tooltip" data-mdb-placement="bottom" title="Détails">
													<i class="far fa-eye"></i>
												</a>

												{# Bouton pour éditer la sortie #}
												<a class="--edit btn btn-warning btn-floating" href="{{ path("app_event_edit", {id:event.id}) }}" role="button" data-mdb-toggle="tooltip" data-mdb-placement="bottom" title="Editer sortie">
													<i class="fas fa-pencil-alt"></i>
												</a>

												{# Bouton pour supprimer la sortie #}
												<a class="--delete btn btn-danger btn-floating" href="{{ path("app_event_delete", {id:event.id}) }}" role="button" data-mdb-toggle="tooltip" data-mdb-placement="bottom" title="Supprimer">
													<i class="fas fa-trash-alt"></i>
												</a>
											</div>
										</div>
									</div>
								</div>
							</div>
						{% endfor %}
						
						{# Fin carte sortie #}
					</section>

					{# Les dernières sorties auxquelles a participé l'utilisateur #}
					<section class="contentProfile__lastExits">
						<h2>Dernières sorties effectuées</h2>
						{# Début carte sortie #}
						{% for event in attendantLastExits %}
							<div class="card mb-3">
								<div class="row g-0">

									<div class="contentProfile__lastExits-picture">
										{# Image de la sortie #}
										<img
											src="https://mdbootstrap.com/wp-content/uploads/2020/06/vertical.jpg"
											alt="Image de la sortie"
											class="img-fluid"
										/>

									</div>

									<div class="contentProfile__lastExits-infos">
										<div class="card-header">
											<h3 class="card-title">{{ event.title }}</h3>
											<p><time datetime="{{ event.eventDate|date("d MMMM Y à HH:mm") }}">{{ event.eventDate|format_date('none', 'd MMMM Y à HH:mm', null, 'gregorian', 'fr') }}</time></p>
										</div>
										<div class="card-body">
											<div class="contentProfile__lastExits-infos_details">
												<p class="card-text"><span>Organisé par :</span> {{ event.author }}</p>
												<p class="card-text"><span>Nbr part :</span> {{ event.attendants|length }} / {{ event.maxAttendants }}</p>
											</div>
											<div class="contentProfile__lastExits-infos_actions">
												{# Bouton pour voir les détails #}
												<a class="--show btn btn-primary btn-floating" href="{{ path("app_event_show", {id:event.id}) }}" role="button" data-mdb-toggle="tooltip" data-mdb-placement="bottom" title="Détails">
													<i class="far fa-eye"></i>
												</a>

												{# Bouton pour ne plus participer à la sortie #}
												<a class="--delete btn btn-danger btn-floating" href="{{ path("app_event_leave", {id:event.id}) }}" role="button" data-mdb-toggle="tooltip" data-mdb-placement="bottom" title="Quitter">
													<i class="fas fa-sign-out-alt"></i>
												</a>
											</div>
										</div>
									</div>
								</div>
							</div>
						{# Fin carte sortie #}
						{% endfor %}
						
					</section>
				</div> {# End panel #}

				<div class="tab-pane fade" id="friend-events" role="tabpanel" aria-labelledby="friend-events-tab">

					{# TODO uniquement version supérieur #}
					<section class="contentProfile__lastExit">
						<h2>Nouveautés de mes amis</h2>
						{# Début carte notifications sur les amis #}
						{% for friend in friends %}
						{% for event in friend.events %}
							{# {% for events in friendEvents %}
							{% for event in events %} #}
								<div class="card mb-3">
									<div class="row g-0">

										<div class="contentProfile__lastExits-picture">
											<!-- Image profil de l'Ami -->
											<img
												src="https://mdbootstrap.com/wp-content/uploads/2020/06/vertical.jpg"
												alt="Image de la sortie"
												class="img-fluid"
											/>
										</div>

										<div class="contentProfile__lastExits-infos">
											<div class="card-header">
												<h3 class="card-title">{{ event.title }}</h3>
												<p><time datetime="{{ event.eventDate|date("d MMMM Y à HH:mm") }}">{{ event.eventDate|format_date('none', 'd MMMM Y à HH:mm', null, 'gregorian', 'fr') }}</time></p>
											</div>
											<div class="card-body">
												<div class="contentProfile__lastExits-infos_details">
													<p class="card-text"><span>Organisé par :</span> <img src="{{ event.author.avatar }}" width="30" class="me-2" />{{ event.author }}</p>
													<p class="card-text"><span>Nbr part :</span> {{ event.attendants|length }} / {{ event.maxAttendants }}</p>
												</div>
												<div class="contentProfile__lastExits-infos_actions">
													{# Bouton pour voir les détails #}
													<a class="--show btn btn-primary btn-floating" href="{{ path("app_event_show", {id:event.id}) }}" role="button" data-mdb-toggle="tooltip" data-mdb-placement="bottom" title="Détails">
														<i class="far fa-eye"></i>
													</a>
												</div>
											</div>
										</div>
									</div>
								</div>
							{% endfor %}
							{% endfor %}
					</section>

				</div> {# End panel #}

				<div class="tab-pane fade" id="saves" role="tabpanel" aria-labelledby="saves-tab">

					{# TODO uniquement dans version supérieure #}
					<section class="contentProfile__lastSearch">
						<h2>Ma recherche du moment</h2>
						<p>Prévoir lien direct vers la recherche sauvegardée</p>
					</section>

				</div> {# End panel #}

			</div>  {# End panels #}

		</div>

	</div>
	
</div>

{% endblock %}